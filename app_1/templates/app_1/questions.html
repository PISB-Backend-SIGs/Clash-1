{% extends 'app_1\base.html' %}
{% block "title" %}
{{title}}
{% endblock "title" %}


{% block "codeblock" %}
<div class="navbar-brand navvi timer" href="#" style="margin-left: 20px;">
    <div class="timer_container">
        <div class=" w-100 d-flex p-0 flex-grow-1" id="countdown">
            <span id="minutes" class="timeritems"></span> :
            <span id="seconds" class="timeritems"></span>
        </div>
      </div>                     
</div>

{% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissable fade show" role="alert">
        <strong>Message:</strong>{{ message }}
    </div>
    {% endfor %}

    <div>
        <h1>marks : {{player.p_current_score}}</h1>
    </div>
     
    <h1>Randomly generated question number = {{question.q_id}}</h1>
    <h1>marks = <span id="marks-add">+{{marking_scheme.marks_add}}</span> <span id="marks-red"> </span></h1>
    
<form action="" method="POST" id="Question_form">
    {% csrf_token %}
    <h2>{{question_number}}) &nbsp; {{question.question}}</h2>

    <input type="radio" name="option" id="opt1" class="option" value=1>
    <label for="opt1">
        <span>{{question.q_option_1}}</span>
    </label>
    <input type="radio" name="option" id="opt2" class="option" value=2>
    <label for="opt2">
        <span>{{question.q_option_2}}</span>
    </label>
    <input type="radio" name="option" id="opt3" class="option" value=3>
    <label for="opt3">
        <span>{{question.q_option_3}}</span>
    </label>
    <input type="radio" name="option" id="opt4" class="option" value=4>
    <label for="opt4">
        <span>{{question.q_option_4}}</span>
    </label>

    {% if flag %}
        <button   type="submit" name="next" id="submit_btn" class="btn btn-primary">Next</button>
    {% else %}
        <!-- <button   type="submit" name="nsubmit" id="submit_btn">Submit</button> -->
        <button   type="submit" name="nsubmit" id="submit_btn" class="btn btn-primary">Submit</button>
    {% endif %}
</form>

<!-- <button id="sub">dfdf</button> -->

<script>
    
    x = setInterval(function() {    
        
        const countDown = new Date('{{player_time}}').getTime();
            const now = new Date().getTime();
            // console.log(new Date())
            remain = countDown - now;
            // console.log("b time",countDown,"f time", now ) 
            // console.log(remain);
  
        //   document.getElementById("days").innerText = Math.floor(distance / (day)),
            let seconds = Math.floor((remain / 1000) % 60);
            let minutes = Math.floor((remain / (1000 * 60)) % 60);
            document.getElementById("minutes").innerText = minutes;
            // sec = toString(seconds)
            // console.log(val_sec)
            if (seconds<10 ){
                document.getElementById("seconds").innerText =  "0"+seconds ;
            }else{
                document.getElementById("seconds").innerText = seconds ;
            }  
          if (remain < 0) {
            const radioInputs = document.querySelectorAll('input[type="radio"]');
            radioInputs.forEach((input) => {
            input.required = false;
            
            });
            // document.getElementById("hours").innerText = 0;
            document.getElementById("minutes").innerText = 0;
            document.getElementById("seconds").innerText = 0;
            var sub_btn = document.getElementById("submit_btn");
            sub_btn.name = "nsubmit";
            sub_btn.click();
            clearInterval(x);
            // window.location.reload();
          }
          //seconds
        },0)


        // const data = '{{ life_line_dict }}';
        var data = JSON.parse("{{life_line_dict|escapejs}}");
        console.log(data);
        if (data.activate){
            document.getElementById("marks-red").innerText = data.marks_red;
            for (let i = 0; i < 2; i++) {
                var opt=document.getElementById("opt"+data.option_disable[i]);
                opt.disabled=true;
                // opt.style.display = 'none';
                
            }
            // if (data.option_disable[0]){

            //     var opt1=document.getElementById("opt1");
            //     opt1.disabled=true;
            //     opt1.style.display = 'none';
            // }
            // if (data.option_disable[1]){
            //     var opt2=document.getElementById("opt2");
            //     opt2.disabled=true;
            //     opt2.style.display = 'none';            }
            // if (data.option_disable[2]){
            //     var opt3=document.getElementById("opt3");
            //     opt3.disabled=true;
            //     opt3.style.display = 'none';            }
            // if (data.option_disable[3]){
            //     var opt4=document.getElementById("opt4");
            //     opt4.disabled=true;
            //     opt4.style.display = 'none';            }
            const radioInputs = document.querySelectorAll('input[type="radio"]');
            radioInputs.forEach((input) => {
            input.required = true;
            
            });

        }else{
            document.getElementById("marks-red").innerText = {{marking_scheme.marks_sub}};
           
        }
</script>

{% endblock "codeblock" %}